!function(t){t.fn.jRating=function(a){var s={bigStarsPath:"http://dx.nguyenpham.info/theme/Volga/img/stars.png",smallStarsPath:"http://dx.nguyenpham.info/theme/Volga/img/small.png",phpPath:"/products/ratings",type:"big",step:!1,isDisabled:!1,showRateInfo:!0,canRateAgain:!1,sendRequest:!0,length:5,decimalLength:1,rateMax:5,rateInfosX:-45,rateInfosY:5,nbRates:.5,onSuccess:null,onError:null,onClick:null};return this.length>0?this.each(function(){function e(t){var a=parseFloat(100*t/v*parseInt(i.rateMax)/100),s=Math.pow(10,parseInt(i.decimalLength)),e=Math.round(a*s)/s;return e}function n(){switch(i.type){case"small":h=12,l=10,p=i.smallStarsPath;break;default:h=23,l=20,p=i.bigStarsPath}}function o(t){return t?t.offsetLeft+o(t.offsetParent):0}var i=t.extend(s,a),r=0,h=0,l=0,p="",c=!1,d=0,u=i.nbRates;if(t(this).hasClass("jDisabled")||i.isDisabled)var f=!0;else var f=!1;n(),t(this).height(l);{var g=parseFloat(t(this).attr("data-average")),m=parseInt(t(this).attr("data-id")),v=h*i.length,R=g/i.rateMax*v,g=(t("<div>",{"class":"jRatingColor",css:{width:R}}).appendTo(t(this)),t("<div>",{"class":"jRatingAverage",css:{width:0,top:-l}}).appendTo(t(this)));t("<div>",{"class":"jStar",css:{width:v,height:l,top:-(2*l),background:"url("+p+") repeat-x"}}).appendTo(t(this))}t(this).css({width:v,overflow:"hidden",zIndex:1,position:"relative"}),f||t(this).unbind().bind({mouseenter:function(a){var s=o(this),n=a.pageX-s;if(i.showRateInfo){t("<p>",{"class":"jRatingInfos",html:e(n)+' <span class="maxRate">/ '+i.rateMax+"</span>",css:{top:a.pageY+i.rateInfosY,left:a.pageX+i.rateInfosX}}).appendTo("body").show()}},mouseover:function(){t(this).css("cursor","pointer")},mouseout:function(){t(this).css("cursor","default"),g.width(c?d:0)},mousemove:function(a){var s=o(this),n=a.pageX-s;r=i.step?Math.floor(n/h)*h+h:n,g.width(r),i.showRateInfo&&t("p.jRatingInfos").css({left:a.pageX+i.rateInfosX}).html(e(r)+' <span class="maxRate">/ '+i.rateMax+"</span>")},mouseleave:function(){t("p.jRatingInfos").remove()},click:function(a){var s=this;c=!0,d=r,u--,(!i.canRateAgain||parseInt(u)<=0)&&t(this).unbind().css("cursor","default").addClass("jDisabled"),i.showRateInfo&&t("p.jRatingInfos").fadeOut("fast",function(){t(this).remove()}),a.preventDefault();var n=e(r);g.width(r),i.onClick&&i.onClick(s,n),i.sendRequest&&t.post(i.phpPath,{idBox:m,rate:n,action:"/products/ratings"},function(a){console.log(a);var s=t.parseJSON(a);0==s.status?(t("#box-message").html('<div id="close-pop"></div>'+s.message),t("#pop-message").show()):t("#change_avg").html(s.message)})}})}):void 0}}(jQuery);