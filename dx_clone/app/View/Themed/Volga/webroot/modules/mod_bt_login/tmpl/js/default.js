function setFPosition(){"center"==btlOpt.ALIGN?BTLJ("#btl-content > div").each(function(){var t="#"+this.id.replace("content","panel"),e=BTLJ(t).offset().left+BTLJ(t).width()/2-BTLJ(this).width()/2;0>e&&(e=0),BTLJ(this).css("left",e)}):"right"==btlOpt.ALIGN?BTLJ("#btl-content > div").css("right",BTLJ(document).width()-BTLJ(".btl-panel").offset().left-BTLJ(".btl-panel").width()):BTLJ("#btl-content > div").css("left",BTLJ(".btl-panel").offset().left),BTLJ("#btl-content > div").css("top",BTLJ(".btl-panel").offset().top+BTLJ(".btl-panel").height()+2)}function showLoginForm(){BTLJ(".btl-panel span").removeClass("active");var t="#btl-panel-login";btlOpt.LOGIN_TAGS&&(t+=", "+btlOpt.LOGIN_TAGS),BTLJ.modal.close();var e=0,o=0;o=371,e=357,e>BTLJ(window).width()&&(e=BTLJ(window).width()-50),BTLJ(t).hasClass("btl-modal")?(BTLJ(t).addClass("active"),BTLJ("#btl-content > div").slideUp(),BTLJ("#btl-content-login").modal({overlayClose:!0,persist:!0,autoPosition:!0,fixed:BTLJ(window).width()>500,onOpen:function(t){t.overlay.fadeIn(),t.container.show(),t.data.show()},onClose:function(t){t.overlay.fadeOut(function(){t.container.hide(),t.data.hide(),BTLJ.modal.close(),BTLJ(".btl-panel span").removeClass("active")})},containerCss:{height:o,width:e}})):(setFPosition(),BTLJ("#btl-content > div").each(function(){"btl-content-login"==this.id?BTLJ(this).is(":hidden")?(BTLJ(t).addClass("active"),BTLJ(this).slideDown()):(BTLJ(this).slideUp(),BTLJ(t).removeClass("active")):BTLJ(this).is(":visible")&&(BTLJ(this).slideUp(),BTLJ("#btl-panel-registration").removeClass("active"))}))}function showRegistrationForm(){if(BTLJ("#btl-integrated").length)return void(window.location.href=BTLJ("#btl-integrated").val());BTLJ(".btl-panel span").removeClass("active"),BTLJ.modal.close();var t="#btl-panel-registration",e=0,o=0;o="auto",e="auto",e>BTLJ(window).width()&&(e=BTLJ(window).width()),BTLJ(t).hasClass("btl-modal")?(BTLJ(t).addClass("active"),BTLJ("#btl-content > div").slideUp(),BTLJ("#btl-content-registration").modal({overlayClose:!0,persist:!0,autoPosition:!0,fixed:BTLJ(window).width()>500,onOpen:function(t){t.overlay.fadeIn(),t.container.show(),t.data.show()},onClose:function(t){t.overlay.fadeOut(function(){t.container.hide(),t.data.hide(),BTLJ.modal.close(),BTLJ(".btl-panel span").removeClass("active")})},containerCss:{height:o,width:e}})):(setFPosition(),BTLJ("#btl-content > div").each(function(){"btl-content-registration"==this.id?BTLJ(this).is(":hidden")?(BTLJ(t).addClass("active"),BTLJ(this).slideDown()):(BTLJ(this).slideUp(),BTLJ(t).removeClass("active")):BTLJ(this).is(":visible")&&(BTLJ(this).slideUp(),BTLJ("#btl-panel-login").removeClass("active"))}))}function showProfile(){setFPosition();var t="#btl-panel-profile";BTLJ("#btl-content > div").each(function(){"btl-content-profile"==this.id?BTLJ(this).is(":hidden")?(BTLJ(t).addClass("active"),BTLJ(this).slideDown()):(BTLJ(this).slideUp(),BTLJ(".btl-panel span").removeClass("active")):BTLJ(this).is(":visible")&&(BTLJ(this).slideUp(),BTLJ(".btl-panel span").removeClass("active"))})}function registerAjax(){if(BTLJ("#btl-registration-error").hide(),BTLJ(".btl-error-detail").hide(),""==BTLJ("#btl-input-name").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("REQUIRED_NAME")).show(),BTLJ("#btl-input-name").focus(),!1;if(""==BTLJ("#btl-input-username1").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("REQUIRED_USERNAME")).show(),BTLJ("#btl-input-username1").focus(),!1;if(""==BTLJ("#btl-input-password1").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("REQUIRED_PASSWORD")).show(),BTLJ("#btl-input-password1").focus(),!1;if(""==BTLJ("#btl-input-password2").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("REQUIRED_VERIFY_PASSWORD")).show(),BTLJ("#btl-input-password2").focus(),!1;if(BTLJ("#btl-input-password2").val()!=BTLJ("#btl-input-password1").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("PASSWORD_NOT_MATCH")).show(),BTLJ("#btl-input-password2").focus().select(),BTLJ("#btl-registration-error").show(),!1;if(""==BTLJ("#btl-input-email1").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("REQUIRED_EMAIL")).show(),BTLJ("#btl-input-email1").focus(),!1;var t=/^[_a-zA-Z0-9-]+(\.[_a-zA-Z0-9-]+)*@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*(\.([a-zA-Z]){2,4})$/;if(!t.test(BTLJ("#btl-input-email1").val()))return BTLJ("#btl-registration-error").html(Joomla.JText._("EMAIL_INVALID")).show(),BTLJ("#btl-input-email1").focus().select(),!1;if(""==BTLJ("#btl-input-email2").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("REQUIRED_VERIFY_EMAIL")).show(),BTLJ("#btl-input-email2").focus().select(),!1;if(BTLJ("#btl-input-email1").val()!=BTLJ("#btl-input-email2").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("EMAIL_NOT_MATCH")).show(),BTLJ("#btl-input-email2").focus().select(),!1;if("recaptcha"==btlOpt.RECAPTCHA){if(BTLJ("#recaptcha_response_field").length&&""==BTLJ("#recaptcha_response_field").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("CAPTCHA_REQUIRED")).show(),BTLJ("#recaptcha_response_field").focus(),!1}else if("2"==btlOpt.RECAPTCHA&&BTLJ("#btl-captcha").length&&""==BTLJ("#btl-captcha").val())return BTLJ("#btl-registration-error").html(Joomla.JText._("CAPTCHA_REQUIRED")).show(),BTLJ("#btl-captcha").focus(),!1;var e=BTLJ(".btl-buttonsubmit input:last").attr("name"),o=encodeURIComponent(BTLJ(".btl-buttonsubmit input:last").val()),n="bttask=register&name="+encodeURIComponent(BTLJ("#btl-input-name").val())+"&username="+encodeURIComponent(BTLJ("#btl-input-username1").val())+"&passwd1="+encodeURIComponent(BTLJ("#btl-input-password1").val())+"&passwd2="+encodeURIComponent(BTLJ("#btl-input-password2").val())+"&email1="+encodeURIComponent(BTLJ("#btl-input-email1").val())+"&email2="+encodeURIComponent(BTLJ("#btl-input-email2").val())+"&"+e+"="+o;return"recaptcha"==btlOpt.RECAPTCHA?n+="&recaptcha=yes&recaptcha_response_field="+encodeURIComponent(BTLJ("#recaptcha_response_field").val())+"&recaptcha_challenge_field="+encodeURIComponent(BTLJ("#recaptcha_challenge_field").val()):"2"==btlOpt.RECAPTCHA&&(n+="&recaptcha=yes&btl_captcha="+encodeURIComponent(BTLJ("#btl-captcha").val())),BTLJ.ajax({type:"POST",beforeSend:function(){BTLJ("#btl-register-in-process").show()},url:btlOpt.BT_AJAX,data:n,success:function(t){BTLJ("#btl-register-in-process").hide(),-1!=t.indexOf("$error$")?(BTLJ("#btl-registration-error").html(t.replace("$error$","")),BTLJ("#btl-registration-error").show(),"recaptcha"==btlOpt.RECAPTCHA?Recaptcha.reload():"2"==btlOpt.RECAPTCHA&&BTLJ.ajax({type:"post",url:btlOpt.BT_AJAX,data:"bttask=reload_captcha",success:function(t){BTLJ("#recaptcha img").attr("src",t)}})):(BTLJ(".btl-formregistration").children("div").hide(),BTLJ("#btl-success").html(t),BTLJ("#btl-success").show(),setTimeout(function(){window.location.reload()},7e3))},error:function(t,e){alert(e+": Ajax request failed")}}),!1}function loginAjax(){if(""==BTLJ("#btl-input-username").val())return showLoginError(Joomla.JText._("REQUIRED_USERNAME")),!1;if(""==BTLJ("#btl-input-password").val())return showLoginError(Joomla.JText._("REQUIRED_PASSWORD")),!1;var t=BTLJ(".btl-buttonsubmit input:last").attr("name"),e=encodeURIComponent(BTLJ(".btl-buttonsubmit input:last").val()),o="bttask=login&username="+encodeURIComponent(BTLJ("#btl-input-username").val())+"&passwd="+encodeURIComponent(BTLJ("#btl-input-password").val())+"&"+t+"="+e+"&return="+encodeURIComponent(BTLJ("#btl-return").val());return BTLJ("#btl-checkbox-remember").is(":checked")&&(o+="&remember=yes"),BTLJ.ajax({type:"POST",beforeSend:function(){BTLJ("#btl-login-in-process").show(),BTLJ("#btl-login-in-process").css("height",BTLJ("#btl-content-login").outerHeight()+"px")},url:btlOpt.BT_AJAX,data:o,success:function(t){"1"==t||1==t?window.location.href=btlOpt.BT_RETURN:-1==t.indexOf("</head>")?showLoginError(Joomla.JText._("E_LOGIN_AUTHENTICATE")):-1==t.indexOf("btl-panel-profile")?showLoginError("Another plugin has redirected the page on login, Please check your plugins system"):window.location.href=btlOpt.BT_RETURN},error:function(t,e){alert(e+": Ajax request failed!")}}),!1}function showLoginError(t,e){BTLJ("#btl-login-in-process").hide(),BTLJ("#btl-login-error").html(t),BTLJ("#btl-login-error").show(),e&&setTimeout(function(){window.location.reload()},5e3)}if(jQuery.noConflict(),"undefined"==typeof BTLJ)var BTLJ=jQuery;if("undefined"==typeof btTimeOut)var btTimeOut;if("undefined"==typeof requireRemove)var requireRemove=!0;BTLJ(document).ready(function(){BTLJ("#btl-content").appendTo("body"),BTLJ(".btl-input #jform_profile_aboutme").attr("cols",21),BTLJ(".bt-scroll .btl-buttonsubmit").click(function(){setTimeout(function(){if(BTLJ("#btl-registration-error").is(":visible"))BTLJ(".bt-scroll").data("jsp").scrollToY(0,!0);else{var t=BTLJ(".bt-scroll").find(".invalid:first").position();t&&BTLJ(".bt-scroll").data("jsp").scrollToY(t.top-15,!0)}},20)}),BTLJ(".btl-dropdown").length&&(setFPosition(),BTLJ(window).resize(function(){setFPosition()})),BTLJ(btlOpt.LOGIN_TAGS).addClass("btl-modal"),""!=btlOpt.REGISTER_TAGS&&BTLJ(btlOpt.REGISTER_TAGS).addClass("btl-modal");var t="#btl-panel-login";btlOpt.LOGIN_TAGS&&(t+=", "+btlOpt.LOGIN_TAGS),"click"==btlOpt.MOUSE_EVENT?BTLJ(t).click(function(t){showLoginForm(),t.preventDefault()}):BTLJ(t).hover(function(){showLoginForm()},function(){}),t="#btl-panel-registration",btlOpt.REGISTER_TAGS&&(t+=", "+btlOpt.REGISTER_TAGS),"click"==btlOpt.MOUSE_EVENT?(BTLJ(t).click(function(t){showRegistrationForm(),t.preventDefault()}),BTLJ("#btl-panel-profile").click(function(t){showProfile(),t.preventDefault()})):(BTLJ(t).hover(function(){BTLJ("#btl-integrated").length||showRegistrationForm()},function(){}),BTLJ("#btl-panel-profile").hover(function(){showProfile()},function(){})),BTLJ("#register-link a").click(function(t){BTLJ(".btl-modal").length?(BTLJ.modal.close(),setTimeout("showRegistrationForm();",1e3)):showRegistrationForm(),t.preventDefault()}),BTLJ(document).click(function(t){requireRemove&&1==t.which&&(btTimeOut=setTimeout('BTLJ("#btl-content > div").slideUp();BTLJ(".btl-panel span").removeClass("active");',10)),requireRemove=!0}),BTLJ(".btl-content-block").click(function(){requireRemove=!1}),BTLJ(".btl-panel span").click(function(){requireRemove=!1}),BTLJ("#btl-iframe").load(function(){oldAction=BTLJ("#btl-iframe").contents().find("form").attr("action"),null!=oldAction&&-1==oldAction.search("tmpl=component")&&(-1!=BTLJ("#btl-iframe").contents().find("form").attr("action").indexOf("?")?BTLJ("#btl-iframe").contents().find("form").attr("action",oldAction+"&tmpl=component"):BTLJ("#btl-iframe").contents().find("form").attr("action",oldAction+"?tmpl=component"))}),BTLJ("span#btl-captcha-reload").click(function(){BTLJ.ajax({type:"post",url:btlOpt.BT_AJAX,data:"bttask=reload_captcha",success:function(t){BTLJ("#recaptcha img").attr("src",t)}})})});